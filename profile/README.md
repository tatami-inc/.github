# Matrix representations in C++

## About

(No, we're not really a corporation. 
I couldn't get the **@tatami** or **@tatami-galaxy** handles because they were already taken.)

**tatami**  is a C++ library that implements read access to a variety of matrix representations through a common interface.
Developers can use this interface to create applications that can extract data from diverse matrix representations,
whether it be dense or sparse, row-major or column-major, in-memory or file-backed, with or without delayed operations, and so on.
It was initially developed to support scalable analyses of genomics datasets, where the matrix representation can be easily substituted depending on the circumstances.
**tatami**-powered applications can be used to process small in-memory matrices on a laptop, or large file-backed matrices on a high performance compute node.

Matrix representations currently supported by **tatami** include:

- Dense row/column major matrices, with user-defined storage modes and containers.
- Compressed sparse row/column matrices, with user-defined storage modes and containers.
- Matrices generated by delayed operations, ~stolen~ inspired by those in [**DelayedArray**](https://github.com/Bioconductor/DelayedArray).
- Matrices backed by [HDF5](https://www.hdfgroup.org) files, either as dense datasets or in a compressed sparse format.
- Matrices backed by dense or sparse [TileDB](https://tiledb.com) arrays.
- Wrappers around R matrices that cannot be transformed into the above types, for use within R packages.

## Getting started

### Using C++ 

**tatami** is implemented as a header-only C++ library and can be dropped directly into an existing project.
Check out the [core repository](https://github.com/tatami-inc/tatami) for more details;
this provides the interface as well as many of the in-memory representations and delayed operations.

**tatami** extensions provide more matrix representations and can be included on an as-needed basis.
As these often depend on additional third-party libraries, they are not included as part of the core **tatami** library. 

- [**tatami_hdf5**](https://github.com/tatami-inc/tatami_hdf5) provides representations for HDF5-backed matrices.
- [**tatami_tiledb**](https://github.com/tatami-inc/tatami_tiledb) provides representations for TileDB-backed matrices.
- [**tatami_r**](https://github.com/tatami-inc/tatami_r) provides representations for unknown R matrices.

### Using R

The **beachmat** R package ([Bioconductor](https://bioconductor.org/packages/beachmat), [GitHub](https://github.com/tatami-inc/beachmat)) vendors the **tatami** library,
allowing R package developers to compile their C++ code against the **tatami** interface.
It also implements the `initializeCpp()` generic that maps an abstract R matrix to a suitable C++ representation for immediate use by package code.

**beachmat** has several extension packages that mirror those of **tatami**.
These can be `import`ed by package developers or users on an as-needed basis, assuming that the additional dependencies are acceptable.

- [**beachmat.hdf5**](https://github.com/tatami-inc/beachmat.hdf5) vendors **tatami_hdf5** and implements `initializeCpp()` methods for [**HDF5Array**](https://bioconductor.org/packages/HDF5Array) classes.

## Use cases

The [**scran.js**](https://github.com/kanaverse/scran.js) Javascript package compiles **tatami** to WebAssembly to enable single-cell analyses in the browser.

The [**SingleR**](https://bioconductor.org/packages/SingleR) R package uses **beachmat** to implement matrix representations for its C++ cell annotation library.

Got a use case that we don't know about? Make a PR and add it here!

## References

Lun ATL, Pag√®s H, Smith ML (2018). 
"beachmat: A Bioconductor C++ API for accessing high-throughput biological data from a variety of R matrix types."
_PLoS Comput. Biol._, 14(5), e1006135. 
[doi:10.1371/journal.pcbi.1006135](https://doi.org/doi:10.1371/journal.pcbi.1006135)


